@model CentralisationV0.Models.Entities.IndexAndDetailsViewModel




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Boxicons -->
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <!-- My CSS -->
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <!-- Inclure la bibliothèque SweetAlert2 depuis un CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="~/js/customScript.js"></script>


    <!-- Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.0/sweetalert.min.js"></script>
    <!-- My CSS -->


    <link rel="stylesheet" href="~/Content/styles/style.css">
    <link rel="stylesheet" href="~/Content/styles/styleIndex.css">

    <link rel="stylesheet" href="~/Content/styles/styleProjet.css">
    <link rel="stylesheet" href="~/Content/styles/styleClient.css">


    <title>GEOMATIC</title>
</head>
<body>


    <!-- SIDEBAR -->
    <section id="sidebar">
        <div class="logo-nav">
            <a href="index.html" class="brand">
                <img src="~/Content/img/logo-geomatic.png" style="width: 70%;" />
            </a>
        </div>
        <ul class="side-menu top">
            <li>
                <a href="~/Account/Index">
                    <i class='bx bxs-dashboard'></i>
                    <span class="text">Tableau de bord</span>
                </a>
            </li>
            <li>
                <a href="~/donnee/Index">
                    <i class='bx bxs-doughnut-chart'></i>
                    <span class="text">Données</span>
                </a>
            </li>
            <li class="active">
                <a href="~/Projet/Index">
                    <i class='bx bxs-shopping-bag-alt'></i>
                    <span class="text">Projets</span>
                </a>
            </li>

            <li>
                <a href="Clients.html">
                    <i class='bx bxs-message-dots'></i>
                    <span class="text">Clients</span>
                </a>
            </li>
            <li>
                <a href="Equipe.html">
                    <i class='bx bxs-group'></i>
                    <span class="text">Equipe</span>
                </a>
            </li>
        </ul>
        <ul class="side-menu">
            <li>
                <a href="Parametre.html">
                    <i class='bx bxs-cog'></i>
                    <span class="text">Paramètres</span>
                </a>
            </li>
            <li>
                <a href="Connexion.html" class="logout">
                    <i class='bx bxs-log-out-circle'></i>
                    <span class="text">Se deconnecter</span>
                </a>
            </li>
        </ul>
    </section>
    <!-- SIDEBAR -->
    <!-- CONTENT -->
    <section id="content">
        <!-- NAVBAR -->
        <nav>
            <i class='bx bx-menu'></i>

            <form action="#">
                <div class="form-input">
                    <input type="search" placeholder="Recherche...">
                    <button type="submit" class="search-btn"><i class='bx bx-search'></i></button>
                </div>
            </form>
            <input type="checkbox" id="switch-mode" hidden>
            <label for="switch-mode" class="switch-mode"></label>
            <a href="#" class="notification">
                <i class='bx bxs-bell'></i>
                <span class="num">8</span>
            </a>
            <a href="Projets.html" class="profile">
                <img src="img/people.png">
            </a>
        </nav>
        <!-- NAVBAR -->
        <!-- MAIN -->
        <main>
            <div class="head-title">
                <div class="left">
                    <h1>Clients</h1>

                </div>

            </div>

            <div class="head-title">
                <div class="left">
                    <h1></h1>
                    <ul class="breadcrumb">

                        <li></li>
                        <li>

                        </li>
                    </ul>
                </div>

                <span data-toggle="modal" data-target="#ModalAddingClient" class="btn-download addData" style="margin-top: 10px;cursor:pointer">
                    <i class='bx bx-plus-circle'></i>
                    <span class="text">Ajouter un client</span>
                </span>
            </div>
            <div class="table-data">
                <div class="order">
                    <div class="head">

                        <h3>Clients</h3>
                        <i class='bx bx-search'></i>
                        <i class='bx bx-filter'></i>
                    </div>
                    <table id="projetinfo">
                        <thead>
                            <tr>
                                <th style="text-align: center;">Nom de client</th>
                                <th style="text-align:center;">Adresse</th>
                                <th style="text-align:center;">Email</th>
                                <th style="text-align:center;">Industrie</th>
                                <th style="text-align:center;">Type de Client</th>
                                <th style="text-align:center;">Contact Associes</th>
                                <th style="text-align:center;">ArcGISSolution Associes</th>
                                <th style="text-align:center;">Actions</th>

                            </tr>
                        </thead>
                        <tbody id="clientBody">
                            @if (Model != null && Model.Clients != null)
                            {
                                foreach (var client in Model.Clients)
                                {
                <tr data-collaboration-name="@client.clientName" data-id="@client.idClient">
                    <td style="text-align: center;">@client.clientName</td>
                    <td style="text-align: center;">@client.clientAddress</td>
                    <td style="text-align: center;">@client.clientEmail</td>
                    <td style="text-align: center;">@client.clientIndustry</td>
                    <td style="text-align: center;">@client.clientType</td>
                    <td style="text-align: center;">
                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#ModalShowContacts" data-id="@client.idClient" onclick="showContacts(this)">
                            <i class='bx bx-show' style="font-size: 14px;"></i>
                        </span>

                    </td>
                    <td style="text-align: center;">
                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#ModalShowArcgisSolutions" data-id="@client.idClient" onclick="showArcgisSolutions(this)">
                            <i class='bx bx-show' style="font-size: 14px;"></i>
                        </span>

                    </td>

                    <td style="text-align: center;">
                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalEditClient" data-id="@client.idClient" onclick="openEditClientModal(this)">
                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                        </span>
                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#ModalDetaildeClient" data-id="@client.idClient" onclick="AfficherClientDetails(this)">
                            <i class='bx bx-show' style="font-size: 14px;"></i>
                        </span>
                        <button type="button" class="status completed delete-button" style="background-color: red;" data-id="@client.idClient" onclick="deleteClient(this)">
                            <i class='bx bx-trash' style="font-size: 14px;"></i>
                        </button>
                    </td>
                </tr>}
                            }
                        </tbody>

                        <!-- Modal pour les contacts associés -->
                        <div class="modal fade" id="ModalShowContacts" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Contacts Associés</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" id="contactsModalBody">
                                        <!-- Les contacts associés seront chargés ici -->
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <!-- Modal pour les solutions ArcGIS associées -->
                        <div class="modal fade" id="ModalShowArcgisSolutions" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Solutions ArcGIS Associées</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body" id="arcgisSolutionsModalBody">
                                        <!-- Les solutions ArcGIS associées seront chargées ici -->
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <script>
                            // Fonction pour afficher les contacts associés
                            function showContacts(element) {
                                var clientId = $(element).data('id');

                                $.ajax({
                                    type: 'GET',
                                    url: '/Client/GetContacts', // L'URL de l'action qui récupère les contacts
                                    data: { clientId: clientId },
                                    success: function (response) {
                                        if (response.success) {
                                            console.log(response.contacts); // Vérification des données récupérées

                                            var contacts = response.contacts;
                                            var contactsTable = '<table class="table"><thead><tr><th>Nom</th><th>Email</th></tr></thead><tbody>';

                                            $.each(contacts, function (_, contact) {
                                                contactsTable += '<tr><td>' + contact.clientName + '</td><td>' + contact.clientEmail + '</td></tr>';
                                            });

                                            contactsTable += '</tbody></table>';


                                            // Affiche le tableau dans le modal
                                            $('#contactsModalBody').html(contactsTable);
                                            $('#ModalShowContacts').modal('hide');

                                        } else {
                                            alert('Erreur lors de la récupération des contacts.');
                                        }
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Erreur: ' + error);
                                        alert('Une erreur est survenue lors de la récupération des contacts.');
                                    }
                                });
                            }

                            // Fonction pour afficher les solutions ArcGIS associées
                            function showArcgisSolutions(element) {
                                var clientId = $(element).data('id');

                                $.ajax({
                                    type: 'GET',
                                    url: '/Client/GetArcgisSolutions', // L'URL de l'action qui récupère les solutions ArcGIS
                                    data: { clientId: clientId },
                                    success: function (response) {
                                        if (response.success) {
                                            var solutions = response.arcgisSolutions;
                                            var solutionsTable = '<table class="table"><thead><tr><th>Nom</th><th>Description</th></tr></thead><tbody>';

                                            $.each(solutions, function (_, solution) {
                                                solutionsTable += '<tr><td>' + solution.TitredArcgisSolution + '</td><td>' + solution.DescriptionRole + '</td></tr>';
                                            });

                                            solutionsTable += '</tbody></table>';


                                            // Affiche le tableau dans le modal
                                            $('#arcgisSolutionsModalBody').html(solutionsTable);
                                            $('#ModalShowArcgisSolutions').modal('hide');
                                        } else {
                                            alert('Erreur lors de la récupération des solutions ArcGIS.');
                                        }
                                    },
                                    error: function (xhr, status, error) {
                                        console.error('Erreur: ' + error);
                                        alert('Une erreur est survenue lors de la récupération des solutions ArcGIS.');
                                    }
                                });
                            }


                        </script>
                        <script>
                            function AfficherClientDetails(element) {
                                var clientId = $(element).data('id');

                                $.ajax({
                                    url: '/Client/GetClientDetails', // Change le chemin selon ton contrôleur
                                    type: 'GET',
                                    data: { id: clientId },
                                    success: function (data) {
                                        $('#labelNomClient').text(data.Nom);
                                        $('#labelAdresseClient').text(data.Adresse);
                                        $('#labelEmailClient').text(data.Email);
                                        $('#labelIndustrie').text(data.Industrie);
                                        $('#labelTypeClient').text(data.TypeClient);

                                        $('#ModalDetaildeClient').modal('hide');
                                    },
                                    error: function (xhr, status, error) {
                                        alert('Erreur lors de la récupération des détails du client: ' + error);
                                    }
                                });
                            }

                        </script>
                        <script>
                            function deleteClient(button) {
                                var clientId = $(button).data('id');

                                // Demander confirmation avant de supprimer
                                if (confirm("Êtes-vous sûr de vouloir supprimer ce client ?")) {
                                    $.ajax({
                                        url: '/Client/Delete',  // URL vers l'action du contrôleur pour la suppression
                                        type: 'POST',
                                        data: { idClient: clientId },
                                        success: function (response) {
                                            if (response.success) {
                                                alert(response.message);
                                                location.reload();  // Recharge la page pour refléter les modifications
                                            } else {
                                                alert(response.message);
                                            }
                                        },
                                        error: function (xhr, status, error) {
                                            console.error("Erreur AJAX: ", status, error);
                                            alert("Une erreur est survenue lors de la suppression du client.");
                                        }
                                    });
                                }
                            }

                        </script>


                        <table id="donneInfo" style="width: 150%;display: none;">
                            <thead>
                                <tr>
                                    <th style="text-align: center;">Titre</th>
                                    <th style="text-align: center;">Date Réception</th>
                                    <th style="text-align: center;">Date de Publication </th>
                                    <th style="text-align: center;">Date Dernièr Mise à Jour </th>
                                    <th style="text-align: center;">Description </th>
                                    <th style="text-align: center;">Catégorie</th>
                                    <th style="text-align: center;">Thème</th>
                                    <th style="text-align: center;">Couverture</th>
                                    <th style="text-align: center;">Résolution Spatial</th>
                                    <th style="text-align: center;">Résumé</th>
                                    <th style="text-align: center;">Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="text-align: center;">

                                        <p>Projet 1</p>
                                        <img src="img/oncf.png">
                                    </td>
                                    <td style="text-align: center;">01/10/2021</td>
                                    <td style="text-align: center;">05/10/2022</td>
                                    <td style="text-align: center;">05/10/2024</td>
                                    <td style="text-align: center;">Modification donnee</td>
                                    <td style="text-align: center;">Chemin de fer</td>
                                    <td style="text-align: center;">Transport</td>
                                    <td style="text-align: center;">Casa/Rabat</td>
                                    <td style="text-align: center;">résolution oncf</td>
                                    <td style="text-align: center;">résumé oncf</td>
                                    <td style="text-align: center;">
                                        <span class="status completed downdata-button">
                                            <i class='bx bxs-download' style="font-size: 14px;"></i> <!-- Use the download icon class -->
                                        </span>
                                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalUpdating" onclick="uulateUpdateModal(this)">
                                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                                        </span>

                                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#exampleModal">
                                            <i class='bx bx-show' style="font-size: 14px;"></i> <!-- Show icon remains unchanged -->
                                        </span>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align: center;">

                                        <p>Projet 2</p>
                                        <img src="img/onssa.png">
                                    </td>
                                    <td style="text-align: center;">01/10/2021</td>
                                    <td style="text-align: center;">05/10/2022</td>
                                    <td style="text-align: center;">05/10/2023</td>
                                    <td style="text-align: center;">Modification donnee</td>
                                    <td style="text-align: center;">Contrôle de qualité</td>
                                    <td style="text-align: center;">Climat et Agriculture</td>
                                    <td style="text-align: center;">Casa/Rabat</td>
                                    <td style="text-align: center;">résolution ONSSA</td>
                                    <td style="text-align: center;">résumé ONSSA</td>
                                    <td style="text-align: center;">
                                        <span class="status completed downdata-button">
                                            <i class='bx bxs-download' style="font-size: 14px;"></i> <!-- Use the download icon class -->
                                        </span>
                                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalUpdating" onclick="populateUpdateModal(this)">
                                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                                        </span>

                                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#exampleModal">
                                            <i class='bx bx-show' style="font-size: 14px;"></i> <!-- Show icon remains unchanged -->
                                        </span>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align: center;">

                                        <p>Projet 3</p>
                                        <img src="img/radeef.jpg">
                                    </td>
                                    <td style="text-align: center;">01/10/2021</td>
                                    <td style="text-align: center;">05/10/2022</td>
                                    <td style="text-align: center;">05/10/2023</td>
                                    <td style="text-align: center;">Modification donnee</td>
                                    <td style="text-align: center;">Eléctricité et l'Eeau</td>
                                    <td style="text-align: center;">la distribution d'eau et d'électricité</td>
                                    <td style="text-align: center;">Fes</td>
                                    <td style="text-align: center;">résolution RADEEF</td>
                                    <td style="text-align: center;">résumé RADEEF</td>
                                    <td style="text-align: center;">
                                        <span class="status completed downdata-button">
                                            <i class='bx bxs-download' style="font-size: 14px;"></i> <!-- Use the download icon class -->
                                        </span>
                                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalUpdating" onclick="populateUpdateModal(this)">
                                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                                        </span>

                                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#exampleModal">
                                            <i class='bx bx-show' style="font-size: 14px;"></i> <!-- Show icon remains unchanged -->
                                        </span>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align: center;">

                                        <p>Projet 4</p>
                                        <img src="img/lydec.png">
                                    </td>
                                    <td style="text-align: center;">01/10/2021</td>
                                    <td style="text-align: center;">05/10/2022</td>
                                    <td style="text-align: center;">05/03/2023</td>
                                    <td style="text-align: center;">Modification donnee</td>
                                    <td style="text-align: center;">Eléctricité et l'Eeau</td>
                                    <td style="text-align: center;">la distribution d'eau et d'électricité</td>
                                    <td style="text-align: center;">Casa/Rabat</td>
                                    <td style="text-align: center;">résolution LYDEC</td>
                                    <td style="text-align: center;">résumé LYDEC</td>
                                    <td style="text-align: center;">
                                        <span class="status completed downdata-button">
                                            <i class='bx bxs-download' style="font-size: 14px;"></i> <!-- Use the download icon class -->
                                        </span>
                                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalUpdating" onclick="populateUpdateModal(this)">
                                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                                        </span>

                                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#exampleModal">
                                            <i class='bx bx-show' style="font-size: 14px;"></i> <!-- Show icon remains unchanged -->
                                        </span>
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align: center;">

                                        <p>IAM</p>
                                        <img src="img/IAM.png">
                                    </td>
                                    <td style="text-align: center;">01/10/2021</td>
                                    <td style="text-align: center;">05/10/2022</td>
                                    <td style="text-align: center;">05/01/2023</td>
                                    <td style="text-align: center;">Modification donnee</td>
                                    <td style="text-align: center;">Télecommunication</td>
                                    <td style="text-align: center;">Centre de Télecommunication</td>
                                    <td style="text-align: center;">Casa/Rabat</td>
                                    <td style="text-align: center;">résolution IAM</td>
                                    <td style="text-align: center;">résumé IAM</td>
                                    <td style="text-align: center;">
                                        <span class="status completed downdata-button">
                                            <i class='bx bxs-download' style="font-size: 14px;"></i> <!-- Use the download icon class -->
                                        </span>
                                        <span class="status completed edit-button" style="background-color: green;" data-toggle="modal" data-target="#ModalUpdating" onclick="populateUpdateModal(this)">
                                            <i class='bx bx-edit' style="font-size: 14px;"></i>
                                        </span>

                                        <span class="status completed show-button" style="background-color: rgb(224, 159, 125);" data-toggle="modal" data-target="#exampleModal">
                                            <i class='bx bx-show' style="font-size: 14px;"></i> <!-- Show icon remains unchanged -->
                                        </span>
                                    </td>

                                </tr>
                            </tbody>
                        </table>
                        <!-- Modal for displaying project details -->
                        <div class="modal fade" id="ModalDetailProjet" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel">Détails du Projet</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label for="labelProjet" class="col-form-label">Projet:</label>
                                                    <label id="labelProjet" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelClients" class="col-form-label">Clients:</label>
                                                    <label id="labelClients" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelDateDebut" class="col-form-label">Date de Début:</label>
                                                    <label id="labelDateDebut" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelDateFin" class="col-form-label">Date de Fin:</label>
                                                    <label id="labelDateFin" class="col-form-label"></label>
                                                </div>

                                                <div class="form-group">
                                                    <label for="labelTypeCollaboration" class="col-form-label">Type de Collaboration:</label>
                                                    <label id="labelTypeCollaboration" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelDuree" class="col-form-label">Durée (Mois):</label>
                                                    <label id="labelDuree" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelDescription" class="col-form-label">Description:</label>
                                                    <label id="labelDescription" class="col-form-label"></label>
                                                </div>
                                                <div class="form-group">
                                                    <label for="labelStatus" class="col-form-label">Statut:</label>
                                                    <label id="labelStatus" class="col-form-label"></label>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="labelFileSelection" class="col-form-label">Fichiers sélectionnés:</label>
                                                <div id="labelFileSelection" class="col-form-label"></div>
                                            </div>


                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                </div>
                            </div>
                        </div>
                </div>



                <!-- Modal for adding a client -->
                <div class="modal fade" id="ModalAddingClient" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form id="formAjouterClient" method="post">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Ajouter un Client</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <!-- Left Column -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputNomClientt" class="col-form-label">Nom de client</label>
                                                <input type="text" class="form-control" id="inputNomClientt" name="inputNomClientt" value="">
                                            </div>
                                            <div class="form-group">
                                                <label for="inputAdressee" class="col-form-label">Adresse</label>
                                                <input type="text" class="form-control" id="inputAdressee" name="inputAdressee">
                                            </div>
                                            <div class="form-group">
                                                <label for="inputEmaill" class="col-form-label">Email</label>
                                                <input type="email" class="form-control" id="inputEmaill" name="inputEmaill">
                                            </div>
                                        </div>

                                        <!-- Right Column -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputIndustriee" class="col-form-label">Industrie</label>
                                                <textarea class="form-control" id="inputIndustriee" name="inputIndustriee" rows="5"></textarea>
                                            </div>
                                        </div>

                                        <!-- Type de Client -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="inputTypeClient" class="col-form-label">Type de client:</label>
                                                <select class="form-control" id="inputTypeClientt" name="inputTypeClientt">
                                                    <option value="Individuel">Individuel</option>
                                                    <option value="PME">PME</option>
                                                    <option value="Grand Compte">Grand Compte</option>
                                                    <option value="Institutionnel">Institutionnel</option>
                                                    <option value="B2B">B2B</option>
                                                    <option value="B2C">B2C</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Contact Client Multi-Selection -->
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label class="col-sm-3 col-form-label">Contacts Clients :</label>
                                                <div class="input-group">
                                                    <div class="dropdown" style="width: 100%;">
                                                        <button class="btn btn-secondary dropdown-toggle" style="width: 100%; background-color:white; color:black;" type="button" id="contactDropdownButton" data-bs-toggle="dropdown" aria-expanded="false">
                                                            <span id="contactCheckboxCount">0</span> Sélectionné(s)
                                                        </button>
                                                        <ul class="dropdown-menu" aria-labelledby="contactDropdownButton" id="contactDropdownMenu">
                                                            @foreach (var contactClient in Model.ContactClients)
                                                            {
                                                <li>
                                                    <label class="dropdown-item">
                                                        <input type="checkbox" value="@contactClient.idContactClient" name="contactClients" id="contactClients" /> @contactClient.clientName
                                                    </label>
                                                </li>}
                                                        </ul>
                                                    </div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-primary" type="button" id="addContactClientButton" data-toggle="modal" data-target="#ModalAddingContactClient">Ajouter Contact</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <!-- ArcGIS Solutions Dropdown -->
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label class="col-sm-3 col-form-label">ArcGIS Solutions:</label>
                                                <div class="input-group">
                                                    <div class="dropdown" style="width: 100%;">
                                                        <button class="btn btn-secondary dropdown-toggle" style="width: 100%; background-color:white; color:black;" type="button" id="arcgisDropdownButton" data-bs-toggle="dropdown" aria-expanded="false">
                                                            <span id="arcgisCheckboxCount">0</span> Sélectionné(s)
                                                        </button>
                                                        <ul class="dropdown-menu" aria-labelledby="arcgisDropdownButton" id="arcgisDropdownMenu">
                                                            @foreach (var solution in Model.ArcgisSolutions)
                                                            {
                                                <li>
                                                    <label class="dropdown-item">
                                                        <input type="checkbox" value="@solution.idArcgisSolution" name="arcgisSolutions" id="arcgisSolutions" /> @solution.TitredArcgisSolution
                                                    </label>
                                                </li>
}
                                                        </ul>
                                                    </div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-primary" type="button" id="addArcgisSolutionButton" data-toggle="modal" data-target="#ModalAddingArcgisSolution">Ajouter Solution ArcGIS</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                    <button type="button" id="btnAddClientde" class="btn btn-primary">Ajouter</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>



                <div class="modal fade" id="ModalAddingContactClient" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Ajouter un Contact des clients</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="inputClientNom" class="col-form-label">Nom:</label>
                                            <input type="text" class="form-control" id="inputClientNom">
                                        </div>
                                        <div class="form-group">
                                            <label for="inputTelephoneClients" class="col-form-label">Numéro de téléphone:</label>
                                            <input type="text" class="form-control" id="inputTelephoneClients">
                                        </div>


                                        <div class="form-group">
                                            <label for="inputEmailClients" class="col-form-label">Email:</label>
                                            <input type="text" class="form-control" id="inputEmailClients">
                                        </div>

                                    </div>

                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                <button type="button" id="btnAddContactclient" class="btn btn-primary">Ajouter</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Modal for adding ArcGIS Solution -->
                <div class="modal fade" id="ModalAddingArcgisSolution" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Ajouter une Solution ArcGIS</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label for="inputArcgisSolutionNom" class="col-form-label">Nom de la solution:</label>
                                    <input type="text" class="form-control" id="inputArcgisSolutionNom">
                                </div>
                                <div class="form-group">
                                    <label for="inputArcgisSolutionDescription" class="col-form-label">Description:</label>
                                    <textarea class="form-control" id="inputArcgisSolutionDescription"></textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                <button type="button" id="btnAddArcgisSolution" class="btn btn-primary">Ajouter</button>
                            </div>
                        </div>
                    </div>
                </div>





                <script>
                    $(document).ready(function () {
                        loadArcgisSolutions();
                        $('#btnAddClientde').on('click', function () {
                            var clientNom = $('#inputNomClientt').val();
                            var clientAdresse = $('#inputAdressee').val();
                            var clientEmail = $('#inputEmaill').val();
                            var clientIndustrie = $('#inputIndustriee').val();
                            var clientType = $('#inputTypeClientt').val();
                            var selectedContacts = $('input[name="contactClients"]:checked').map(function () {
                                return this.value;
                            }).get();
                            var SelectedArcgisSolutions = $('input[name="arcgisSolutions"]:checked').map(function () {
                                return this.value;
                            }).get();

                            $.ajax({
                                type: 'POST',
                                url: '/Client/AjouterClient', // Remplacez par l'URL correcte de votre action
                                data: {
                                    clientNom: clientNom,
                                    clientAdresse: clientAdresse,
                                    clientEmail: clientEmail,
                                    clientIndustrie: clientIndustrie,
                                    clientType: clientType,
                                    selectedContacts: selectedContacts,
                                    SelectedArcgisSolutions: SelectedArcgisSolutions
                                },
                                success: function (response) {
                                    if (response.success) {
                                        swal("Succès !", "Client ajouté avec succès!", "success").then(function () {
                                            $('#ModalAddingClient').modal('hide');
                                            loadClients(); // Recharger la liste des clients
                                        });
                                    } else {
                                        alert(response.message);
                                    }
                                },
                                error: function (xhr, status, error) {
                                    alert('Une erreur est survenue lors de l\'ajout du client.');
                                    console.log('Status: ' + status);
                                    console.log('Error: ' + error);
                                    console.log('Response: ' + xhr.responseText);
                                }
                            });
                        });

                        // Charger les clients lors du chargement de la page
                        loadClients();
                    });
                </script>
                <script>
                    function loadArcgisSolutions(callback) {
                        $.ajax({
                            type: 'GET',
                            url: '/Client/GetArcgisSolutionsload', // L'URL correcte de votre action
                            success: function (solutions) {
                                var $dropdownMenu = $('#arcgisDropdownMenu'); // ID de l'élément ul dans le dropdown
                                $dropdownMenu.empty(); // Vider la liste existante

                                // Ajouter des checkboxes pour chaque solution
                                $.each(solutions, function (index, solution) {
                                    var $checkbox = $('<li><label class="dropdown-item"><input type="checkbox" value="' + solution.idArcgisSolution + '" name="arcgisSolutions" /> ' + solution.TitredArcgisSolution + '</label></li>');
                                    $dropdownMenu.append($checkbox);
                                });

                                // Mettre à jour le compteur de sélection
                                updateArcgisCheckboxCount();

                                // Appeler le callback une fois terminé, s'il est fourni
                                if (callback) callback();
                            },
                            error: function (xhr, status, error) {
                                alert('Une erreur est survenue lors du chargement des solutions ArcGIS.');
                                console.log('Status: ' + status);
                                console.log('Error: ' + error);
                                console.log('Response: ' + xhr.responseText);
                            }
                        });
                    }

                    function updateArcgisCheckboxCount() {
                        var count = $('input[name="arcgisSolutions"]:checked').length;
                        $('#arcgisCheckboxCount').text(count);
                    }

                    $(document).ready(function () {
                        // Charger les solutions ArcGIS lors du chargement de la page et définir une fonction de callback
                        loadArcgisSolutions(function () {
                            // Vous pouvez ajouter ici des actions à effectuer après le chargement des solutions, par exemple, cocher certaines cases.
                            // Par exemple, cochez les solutions déjà sélectionnées
                            var selectedSolutionIds = [/* IDs des solutions sélectionnées */];
                            selectedSolutionIds.forEach(function (id) {
                                $('input[name="arcgisSolutions"][value="' + id + '"]').prop('checked', true);
                            });

                            // Mettre à jour le compteur après avoir coché les solutions
                            updateArcgisCheckboxCount();
                        });

                        // Mettre à jour le compteur lorsque la sélection change
                        $('#arcgisDropdownMenu').on('change', 'input[name="arcgisSolutions"]', function () {
                            updateArcgisCheckboxCount();
                        });
                    });


                </script>

                <script>
                    $(document).ready(function () {
                        $('#btnAddArcgisSolution').on('click', function () {
                            var solutionNom = $('#inputArcgisSolutionNom').val();
                            var solutionDescription = $('#inputArcgisSolutionDescription').val();

                            // Validation rapide pour s'assurer que les champs ne sont pas vides
                            if (solutionNom === '' || solutionDescription === '') {
                                alert('Veuillez remplir tous les champs.');
                                return;
                            }

                            $.ajax({
                                type: 'POST',
                                url: '/Client/AddArcgisSolution',
                                data: {
                                    TitredArcgisSolution: solutionNom,
                                    Description: solutionDescription
                                },
                                success: function (response) {
                                    if (response.success) {
                                        swal("Succès !", "ArcGis solution  ajouté avec succès!", "success").then(function () {
                                            $('#ModalAddingArcgisSolution').modal('hide');
                                            loadArcgisSolutions();
                                        });
                                    } else {
                                        alert(response.message);
                                    }
                                },
                                error: function (xhr, status, error) {
                                    alert('Une erreur est survenue lors de l\'ajout du contact client.');
                                    console.log('Status: ' + status);
                                    console.log('Error: ' + error);
                                    console.log('Response: ' + xhr.responseText);
                                }
                            });
                        });
                        loadArcgisSolutions();
                    });

                </script>

                <script>

                    function loadContactClients() {
                        $.ajax({
                            type: 'GET',
                            url: '/Client/GetContactClients', // L'URL correcte de votre action
                            success: function (clients) {
                                var $dropdownMenu = $('#contactDropdownMenu'); // ID de l'élément ul dans le dropdown
                                $dropdownMenu.empty(); // Vider la liste existante

                                // Ajouter des checkboxes pour chaque client
                                $.each(clients, function (index, client) {
                                    var $checkbox = $('<li><label class="dropdown-item"><input type="checkbox" value="' + client.IdClient + '" name="contactClients" /> ' + client.nom + '</label></li>');
                                    $dropdownMenu.append($checkbox);
                                });

                                // Mettre à jour le compteur de sélection
                                updateContactCheckboxCount();
                            },
                            error: function (xhr, status, error) {
                                alert('Une erreur est survenue lors du chargement des clients.');
                                console.log('Status: ' + status);
                                console.log('Error: ' + error);
                                console.log('Response: ' + xhr.responseText);
                            }
                        });
                    }

                    function updateContactCheckboxCount() {
                        var count = $('input[name="contactClients"]:checked').length;
                        $('#contactCheckboxCount').text(count);
                    }

                    $(document).ready(function () {
                        loadContactClients(); // Charger les contacts clients lors du chargement de la page

                        // Mettre à jour le compteur lorsque la sélection change
                        $('#contactDropdownMenu').on('change', 'input[name="contactClients"]', function () {
                            updateContactCheckboxCount();
                        });
                    });
                </script>

                <script>
                    $(document).ready(function () {
                        $('#btnAddContactclient').on('click', function () {
                            var contactNom = $('#inputClientNom').val();
                            var contactNumero = $('#inputTelephoneClients').val(); // Corrected from 'inputEmailClients'
                            var contactEmail = $('#inputEmailClients').val();

                            $.ajax({
                                type: 'POST',
                                url: '/Client/AddContactClient',
                                data: {
                                    contactNom: contactNom,
                                    contactNumero: contactNumero,
                                    contactEmail: contactEmail
                                },
                                success: function (response) {
                                    if (response.success) {
                                        swal("Succès !", "Contact client ajouté avec succès!", "success").then(function () {
                                            $('#ModalAddingClient').modal('hide');
                                            loadContactClients(); // Recharger la liste des contacts clients
                                        });
                                    } else {
                                        alert(response.message);
                                    }
                                },
                                error: function (xhr, status, error) {
                                    alert('Une erreur est survenue lors de l\'ajout du contact client.');
                                    console.log('Status: ' + status);
                                    console.log('Error: ' + error);
                                    console.log('Response: ' + xhr.responseText);
                                }
                            });
                        });

                        // Charger les contacts clients lors du chargement de la page
                        loadContactClients();
                    });

                </script>
                <!-- Modal for editing a client -->
                <div class="modal fade" id="ModalEditClient" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <form id="formEditClient" method="post">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel">Modifier un Client</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="row">
                                        <input type="hidden" id="editClientId" name="idClient" value="" />
                                        <!-- Left Column -->
                                        <div class="col-md-6">

                                            <div class="form-group">
                                                <label for="editClientName" class="col-form-label">Nom de client</label>
                                                <input type="text" class="form-control" id="editClientName" name="editClientName" value="">
                                            </div>
                                            <div class="form-group">
                                                <label for="editClientAddress" class="col-form-label">Adresse</label>
                                                <input type="text" class="form-control" id="editClientAddress" name="editClientAddress">
                                            </div>
                                            <div class="form-group">
                                                <label for="editClientEmail" class="col-form-label">Email</label>
                                                <input type="email" class="form-control" id="editClientEmail" name="editClientEmail">
                                            </div>
                                        </div>

                                        <!-- Right Column -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="editClientIndustry" class="col-form-label">Industrie</label>
                                                <textarea class="form-control" id="editClientIndustry" name="editClientIndustry" rows="5"></textarea>
                                            </div>
                                        </div>

                                        <!-- Client Type -->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="editClientType" class="col-form-label">Type de client:</label>
                                                <select class="form-control" id="editClientType" name="editClientType">
                                                    <option value="Individuel">Individuel</option>
                                                    <option value="PME">PME</option>
                                                    <option value="Grand Compte">Grand Compte</option>
                                                    <option value="Institutionnel">Institutionnel</option>
                                                    <option value="B2B">B2B</option>
                                                    <option value="B2C">B2C</option>
                                                </select>
                                            </div>
                                        </div>

                                        <!-- Contacts Dropdown -->
                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label class="col-sm-3 col-form-label">Contacts Clients :</label>
                                                <div class="input-group">
                                                    <div class="dropdown" style="width: 100%;">
                                                        <button class="btn btn-secondary dropdown-toggle" style="width: 100%; background-color:white; color:black;" type="button" id="editContactDropdownButton" data-bs-toggle="dropdown" aria-expanded="false">
                                                            <span id="editContactCheckboxCount"></span> Sélectionné(s)
                                                        </button>
                                                        <ul class="dropdown-menu" aria-labelledby="editContactDropdownButton" id="contactDropdowndeMenu">
                                                            <!-- Dynamically populated -->
                                                        </ul>
                                                    </div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-primary" type="button" id="editAddContactClientButton" data-toggle="modal" data-target="#ModalAddingContactClient">Ajouter Contact</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-12">
                                            <div class="form-group">
                                                <label class="col-sm-3 col-form-label">ArcGIS Solutions:</label>
                                                <div class="input-group">
                                                    <div class="dropdown" style="width: 100%;">
                                                        <button class="btn btn-secondary dropdown-toggle" style="width: 100%; background-color:white; color:black;" type="button" id="editArcgisDropdownButton" data-bs-toggle="dropdown" aria-expanded="false">
                                                            <span id="editArcgisCheckboxCount">0</span> Sélectionné(s)
                                                        </button>
                                                        <ul class="dropdown-menu" aria-labelledby="editArcgisDropdownButton" id="arcgisDropdowndeMenu">
                                                            <!-- Dynamically populated -->
                                                        </ul>
                                                    </div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-primary" type="button" id="editAddArcgisSolutionButton" data-toggle="modal" data-target="#ModalAddingArcgisSolution">Ajouter Solution ArcGIS</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                    <button type="button" id="btnEditClient" class="btn btn-primary">Modifier</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Modal for displaying clients details -->
                <div class="modal fade" id="ModalDetaildeClient" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Détails du Client</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="labelProjet" class="col-form-label">Nom de Client:</label>
                                            <span id="labelNomClient" class="col-form-label client-info"></span>
                                        </div>
                                        <div class="form-group">
                                            <label for="labelClients" class="col-form-label">Adresse:</label>
                                            <span id="labelAdresseClient" class="col-form-label client-info"></span>
                                        </div>
                                        <div class="form-group">
                                            <label for="labelDateDebut" class="col-form-label">Email:</label>
                                            <span id="labelEmailClient" class="col-form-label client-info"></span>
                                        </div>
                                        <div class="form-group">
                                            <label for="labelDateFin" class="col-form-label">Industrie:</label>
                                            <span id="labelIndustrie" class="col-form-label client-info"></span>
                                        </div>
                                        <div class="form-group">
                                            <label for="labelTypeCollaboration" class="col-form-label">Type de Client:</label>
                                            <span id="labelTypeClient" class="col-form-label client-info"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

                <!-- Modal for Client Details -->
                <!-- Modal -->
                <div class="modal fade" id="ModalDetailClient" tabindex="-1" role="dialog" aria-labelledby="ModalDetailClientLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="ModalDetailClientLabel">Détails du Client</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <!-- Les détails du client seront chargés ici -->
                                <div id="clientDetailsContainer">
                                    <!-- Contenu du modal sera chargé ici via Ajax -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <script>
    function showClientDetails(button) {
        var clientId = $(button).data('id'); // Obtenir l'ID du client depuis l'attribut data-id

        $.ajax({
            url: '@Url.Action("ClientDetailsPartial", "Client")',
            type: 'GET',
            data: { id: clientId },
            success: function (data) {
                $('#clientDetailsContainer').html(data); // Charger les détails du client dans le container
                $('#ModalDetailClient').modal('hide'); // Afficher le modal
            },
            error: function () {
                alert('Une erreur est survenue lors du chargement des détails du client.');
            }
        });
    }
                </script>



                <script>
                    function openEditClientModal(button) {
                        loadArcgisSolutions();
                        // Extraire l'ID du client à partir du bouton cliqué
                        var clientId = $(button).attr('data-id');
                        $('#editClientId').val(clientId); // Remplir un champ caché avec l'ID du client si nécessaire

                        // Vérifier que l'ID n'est pas nul ou indéfini avant de faire l'appel AJAX
                        if (!clientId) {
                            alert("L'ID du client est manquant.");
                            return;
                        }

                        $.ajax({
                            url: '/Client/GetClientById/' + clientId, // Assurez-vous que l'URL correspond à votre route
                            type: 'GET',
                            success: function (response) {
                                if (response.success) {
                                    var client = response.data;

                                    // Remplir le formulaire avec les données du client
                                    $('#editClientId').val(client.id); // correspond à idClient dans le modèle
                                    $('#editClientName').val(client.name); // correspond à clientName dans le modèle
                                    $('#editClientAddress').val(client.address); // correspond à clientAddress dans le modèle
                                    $('#editClientEmail').val(client.email); // correspond à clientEmail dans le modèle
                                    $('#editClientIndustry').val(client.industry); // correspond à clientIndustry dans le modèle
                                    $('#editClientType').val(client.type); // correspond à clientType dans le modèle

                                    // Mettre à jour les éléments sélectionnés dans les dropdowns
                                    updateDropdowns(client.allContacts, client.contacts, client.allSolutions, client.arcgisSolutions);

                                    // Ouvrir le modal
                                    $('#ModalEditClient').modal('hide');
                                } else {
                                    // Gérer le cas où le client n'a pas été trouvé
                                    alert(response.message || 'Client non trouvé');
                                }
                            },
                            error: function () {
                                // Gérer les erreurs de la requête AJAX
                                alert('Erreur lors de la récupération des données du client.');
                            }
                        });
                    }

                    function updateDropdowns(allContacts, selectedContacts, allSolutions, selectedSolutions) {
                        const contactDropdownMenu = document.getElementById('contactDropdowndeMenu');
                        const arcgisDropdownMenu = document.getElementById('arcgisDropdowndeMenu');

                        // Remove existing options
                        contactDropdownMenu.innerHTML = '';
                        arcgisDropdownMenu.innerHTML = '';

                        // Create a Set of selected contact IDs for easy lookup
                        const selectedContactIds = new Set(selectedContacts.map(contact => contact.id));
                        const selectedSolutionIds = new Set(selectedSolutions.map(solution => solution.id));

                        // Populate contacts dropdown
                        allContacts.forEach(contact => {
                            const contactId = contact.id;
                            const contactName = contact.name;
                            const isChecked = selectedContactIds.has(contactId);

                            // Create elements for contact
                            const listItem = document.createElement('li');
                            const label = document.createElement('label');
                            label.className = 'dropdown-item';

                            const checkbox = document.createElement('input');
                            checkbox.type = 'checkbox';
                            checkbox.value = contactId;
                            checkbox.id = 'contact-' + contactId;

                            // Set checkbox state based on selection
                            checkbox.checked = isChecked;

                            const textNode = document.createTextNode(' ' + contactName);

                            // Append elements
                            label.appendChild(checkbox);
                            label.appendChild(textNode);
                            listItem.appendChild(label);
                            contactDropdownMenu.appendChild(listItem);
                        });

                        // Populate solutions dropdown
                        allSolutions.forEach(solution => {
                            const solutionId = solution.id;
                            const solutionName = solution.name;
                            const isChecked = selectedSolutionIds.has(solutionId);

                            // Create elements for solution
                            const listItem = document.createElement('li');
                            const label = document.createElement('label');
                            label.className = 'dropdown-item';

                            const checkbox = document.createElement('input');
                            checkbox.type = 'checkbox';
                            checkbox.value = solutionId;
                            checkbox.id = 'solution-' + solutionId;

                            // Set checkbox state based on selection
                            checkbox.checked = isChecked;

                            const textNode = document.createTextNode(' ' + solutionName);

                            // Append elements
                            label.appendChild(checkbox);
                            label.appendChild(textNode);
                            listItem.appendChild(label);
                            arcgisDropdownMenu.appendChild(listItem);
                        });

                        // Update the count (optional, adjust as necessary)
                        document.getElementById('editContactCheckboxCount').textContent = selectedContactIds.size;
                        document.getElementById('editArcgisCheckboxCount').textContent = selectedSolutionIds.size;
                    }

                    // Assurez-vous que ce script est appelé lorsque la page est prête
                    $(document).ready(function () {
                        // Ajouter d'autres scripts ou initialisations ici si nécessaire
                    });

                    $('#btnEditClient').on('click', function () {
                        // Récupérer les valeurs des champs du formulaire
                        var updatedClient = {
                            idClient: $('#editClientId').val(),
                            clientName: $('#editClientName').val(),
                            clientAddress: $('#editClientAddress').val(),
                            clientEmail: $('#editClientEmail').val(),
                            clientIndustry: $('#editClientIndustry').val(),
                            clientType: $('#editClientType').val(),
                            // Récupérer les contacts sélectionnés
                            selectedContacts: $('#contactDropdowndeMenu input[type="checkbox"]:checked').map(function () {
                                return $(this).val();
                            }).get().join(','),
                            // Récupérer les solutions ArcGIS sélectionnées
                            selectedSolutions: $('#arcgisDropdowndeMenu input[type="checkbox"]:checked').map(function () {
                                return $(this).val();
                            }).get().join(',')
                        };

                        $.ajax({
                            url: '/Client/UpdateClient', // Remplacez par l'URL correcte
                            type: 'POST',
                            data: updatedClient,
                            success: function (response) {
                                if (response.success) {
                                    $('#ModalEditClient').modal('hide');
                                    alert(response.message); // Afficher un message de succès
                                    location.reload(); // Recharge la page pour refléter les modifications
                                } else {
                                    alert(response.message); // Afficher un message d'erreur
                                }
                            },
                            error: function (xhr, status, error) {
                                console.error("AJAX Error: ", status, error);
                                alert("Une erreur est survenue lors de la mise à jour du client.");
                            }
                        });
                    });
                </script>


                <!-- Update Projet Modal -->
                <!-- Update Projet Modal -->
                <div class="modal fade" id="ModalUpdateProjet" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Modifier le Projet</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <input type="hidden" id="dataId">
                                <div class="row">
                                    <div class="col-md-6">
                                        <!-- Projet -->
                                        <div class="form-group">
                                            <label for="inputProjetUpdate" class="col-form-label">Projet:</label>
                                            <input type="text" class="form-control" id="inputProjetUpdate" name="inputProjetUpdate">
                                        </div>

                                        <!-- Date de Début -->
                                        <div class="form-group">
                                            <label for="inputDateDebutUpdate" class="col-form-label">Date de Début:</label>
                                            <input type="date" class="form-control" id="inputDateDebutUpdate">
                                        </div>
                                        <!-- Date de Fin -->
                                        <div class="form-group">
                                            <label for="inputDateFinUpdate" class="col-form-label">Date de Fin:</label>
                                            <input type="date" class="form-control" id="inputDateFinUpdate">
                                        </div>
                                        <!-- Durée (Mois) -->
                                        <div class="form-group">
                                            <label for="inputDureeUpdate" class="col-form-label">Durée (Mois):</label>
                                            <input type="number" class="form-control" id="inputDureeUpdate" name="inputDureeUpdate">
                                        </div>
                                        <!-- Affichage des fichiers existants -->
                                        <div class="form-group">
                                            <label for="existingFiles" class="col-form-label">Fichiers Existants:</label>
                                            <div style="display: flex; align-items: flex-start;">
                                                <table class="table table-bordered" id="existingFiles" style="width: auto; margin-right: 10px;">
                                                    <thead>
                                                        <tr>
                                                            <th>Nom du fichier</th>
                                                            <th style="text-align: center;">Supprimer</th>
                                                            <button class="btn btn-danger btn-sm delete-file-btn" data-filename="${fileInput.name}" data-collaborationid="${collaborationId}">
                                                                <i class="fas fa-trash"></i>
                                                            </button>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="existingFilesBody">
                                                        <!-- Les lignes seront insérées ici par JavaScript -->
                                                        <div class="form-group">
                                                            <label for="inputDureeUpdate" class="col-form-label">Durée (Mois):</label>
                                                            <input type="number" class="form-control" id="inputDureeUpdate" name="inputDureeUpdate">
                                                        </div>
                                                    </tbody>
                                                </table>

                                                <!-- Section d'upload -->
                                                <div class="upload-icon-wrapper" style="display: flex; align-items: center;">
                                                    <label for="fileUploadInput" class="btn btn-secondary btn-sm" style="margin-right: 10px;">
                                                        <i class="fas fa-upload"></i>
                                                    </label>
                                                    <input type="file" class="form-control-file" id="fileUploadInput" name="file" style="display: none;">
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <!-- Description -->
                                            <div class="form-group">
                                                <label for="inputDescriptionUpdate" class="col-form-label">Description:</label>
                                                <textarea class="form-control" id="inputDescriptionUpdate" rows="5"></textarea>
                                            </div>
                                            <!-- Status -->
                                            <div class="form-group">
                                                <label for="inputStatusUpdate" class="col-form-label">Statut:</label>
                                                <select class="form-control" id="inputStatusUpdate">
                                                    <option value="Finalisé">Finalisé</option>
                                                    <option value="En cours">En cours</option>
                                                    <option value="En attente">En attente</option>
                                                    <option value="Suspendu">Suspendu</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label for="inputTypeCollaborationUpdate" class="col-form-label">Type de collaboration:</label>
                                                <select class="form-control" id="inputTypeCollaborationUpdate">
                                                    <option value="un Projet">un Projet</option>
                                                    <option value="bon de commande">bon de commande</option>
                                                    <option value="Maintenance">Maintenance</option>
                                                    <!-- Add more options as needed -->
                                                </select>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                    <button type="button" class="btn btn-success" id="updateProjetBtn">Modifier</button>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Modal Structure -->
                    <div class="modal fade" id="dataModal" tabindex="-1" role="dialog" aria-labelledby="dataModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="dataModalLabel">Renseignements sur le projet</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <!-- The information from donneInfo will be displayed here -->
                                    <div id="modalDataContent">
                                        <div class="form-group">
                                            <label for="modalTitre">Titre:</label>
                                            <p id="modalTitre"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalDateAcquisition">Date Réception:</label>
                                            <p id="modalDateAcquisition"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalDatePublication">Date de Publication:</label>
                                            <p id="modalDatePublication"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalDatePublication">Date Dernièr Mise à Jour:</label>
                                            <p id="modalDatePublication"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalDescription">Description:</label>
                                            <p id="modalDescription"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalCategorie">Catégorie:</label>
                                            <p id="modalCategorie"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalTheme">Thème:</label>
                                            <p id="modalTheme"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalCouverture">Couverture:</label>
                                            <p id="modalCouverture"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalResolution">Résolution Spatial:</label>
                                            <p id="modalResolution"></p>
                                        </div>
                                        <div class="form-group">
                                            <label for="modalResume">Résumé:</label>
                                            <p id="modalResume"></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button>
                                </div>
                            </div>
                        </div>
                    </div>



                    <script src="~/js/customScript.js" defer></script>

</body>
</html>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Content/Scripts/script.js"></script>
    <script src="~/Content/Scripts/scriptConnexion.js"></script>
    <script src="~/Content/Scripts/scriptIndex.js"></script>s
    <script src="~/Content/Scripts/scriptParamètres.js"></script>

    <script src="~/Content/Scripts/scriptEquipe.js"></script>
    



}
